{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/extends\";\nimport _objectWithoutPropertiesLoose from \"@babel/runtime/helpers/objectWithoutPropertiesLoose\";\n/** @jsx jsx */\n\nimport { jsx } from \"@emotion/core\";\nimport { useEffect, useState, forwardRef } from \"react\";\nimport Box from \"../Box\";\nexport var useHasImageLoaded = function useHasImageLoaded(_ref) {\n  var src = _ref.src,\n      onLoad = _ref.onLoad,\n      onError = _ref.onError;\n\n  var _useState = useState(false),\n      hasLoaded = _useState[0],\n      setHasLoaded = _useState[1];\n\n  useEffect(function () {\n    var image = new window.Image();\n    image.src = src;\n\n    image.onload = function (event) {\n      setHasLoaded(true);\n      onLoad && onLoad(event);\n    };\n\n    image.onError = function (event) {\n      setHasLoaded(false);\n      onError && onError(event);\n    };\n  }, [src, onLoad, onError]);\n  return hasLoaded;\n};\nvar NativeImage = forwardRef(function (_ref2, ref) {\n  var htmlWidth = _ref2.htmlWidth,\n      htmlHeight = _ref2.htmlHeight,\n      alt = _ref2.alt,\n      props = _objectWithoutPropertiesLoose(_ref2, [\"htmlWidth\", \"htmlHeight\", \"alt\"]);\n\n  return jsx(\"img\", _extends({\n    width: htmlWidth,\n    height: htmlHeight,\n    ref: ref,\n    alt: alt\n  }, props));\n});\nvar Image = forwardRef(function (_ref3, ref) {\n  var src = _ref3.src,\n      fallbackSrc = _ref3.fallbackSrc,\n      onError = _ref3.onError,\n      onLoad = _ref3.onLoad,\n      ignoreFallback = _ref3.ignoreFallback,\n      props = _objectWithoutPropertiesLoose(_ref3, [\"src\", \"fallbackSrc\", \"onError\", \"onLoad\", \"ignoreFallback\"]);\n\n  var hasLoaded = useHasImageLoaded({\n    src: src,\n    onLoad: onLoad,\n    onError: onError\n  });\n  var imageProps;\n\n  if (ignoreFallback) {\n    imageProps = {\n      src: src,\n      onLoad: onLoad,\n      onError: onError\n    };\n  } else {\n    imageProps = {\n      src: hasLoaded ? src : fallbackSrc\n    };\n  }\n\n  return jsx(Box, _extends({\n    as: NativeImage,\n    ref: ref\n  }, imageProps, props));\n});\nImage.displayName = \"Image\";\nexport default Image;","map":null,"metadata":{},"sourceType":"module"}